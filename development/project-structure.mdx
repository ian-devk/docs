---
title: "Project Structure"
description: "Comprehensive visual guide to organizing your Shelther project structure. Learn about scalable architecture patterns, component organization, and best practices for safety-critical React Native + Express.js applications."
sidebarTitle: "Project Structure"
---

# Project Structure ğŸ—ï¸

<Info>
**Enterprise-Grade Safety Architecture:** Shelther follows a production-ready structure with clear separation between React Native client, Express.js backend, and Supabase database - designed for 99.9% uptime and safety-critical reliability.
</Info>

## Architecture Overview

```mermaid
graph TB
    subgraph "ğŸ“± React Native Client"
        A1[App Components]
        A2[API Layer]
        A3[State Management]
        A4[Background Tasks]
    end
    
    subgraph "ğŸŒ Express.js Backend"
        B1[API Routes]
        B2[Emergency Services]
        B3[Authentication]
        B4[Background Jobs]
    end
    
    subgraph "ğŸ—„ï¸ Database Layer"
        C1[Supabase PostgreSQL]
        C2[Real-time Engine]
        C3[Row Level Security]
    end
    
    subgraph "â˜ï¸ Railway Platform"
        D1[Always-Warm Servers]
        D2[Auto-Scaling]
        D3[Health Monitoring]
    end
    
    A2 --> B1
    A3 --> B1
    A4 --> B1
    B1 --> B2
    B2 --> C1
    B3 --> C1
    B4 --> C2
    B1 --> D1
    D1 --> D2
    D2 --> D3
    
    style A1 fill:#e3f2fd
    style B1 fill:#f3e5f5
    style C1 fill:#e8f5e8
    style D1 fill:#fff3e0
```

<CardGroup cols={3}>
  <Card title="ğŸ¯ Separation of Concerns" icon="layers">
    **Client:** UI, state management, background tasks  
    **Backend:** Business logic, authentication, emergency processing  
    **Database:** Data storage, real-time subscriptions, security
  </Card>
  <Card title="âš¡ Performance First" icon="zap">
    **Always-warm servers** eliminate cold starts  
    **Optimized bundles** with tree-shaking  
    **Efficient state management** with minimal re-renders
  </Card>
  <Card title="ğŸ›¡ï¸ Safety Architecture" icon="shield">
    **Critical features isolated** in dedicated modules  
    **100% test coverage** for emergency functions  
    **Graceful degradation** for non-critical failures
  </Card>
</CardGroup>

## ğŸ“ Complete Project Structure

### React Native Client Structure

<CodeGroup>
```bash Mobile App Structure (shelther-mobile/)
shelther-mobile/
â”œâ”€â”€ ğŸ“ .expo/                          # Expo development cache
â”œâ”€â”€ ğŸ“ .vscode/                        # VS Code workspace settings
â”œâ”€â”€ ğŸ“ assets/                         # ğŸ¨ Static assets
â”‚   â”œâ”€â”€ ğŸ“ images/
â”‚   â”‚   â”œâ”€â”€ ğŸ“ icons/                  # UI icons & app icons
â”‚   â”‚   â”œâ”€â”€ ğŸ“ emergency/              # Emergency visuals
â”‚   â”‚   â”œâ”€â”€ ğŸ“ onboarding/             # Onboarding screens
â”‚   â”‚   â””â”€â”€ ğŸ“ illustrations/          # Safety illustrations
â”‚   â”œâ”€â”€ ğŸ“ fonts/                      # Custom typography
â”‚   â”œâ”€â”€ ğŸ“ sounds/                     # ğŸ”Š Audio alerts
â”‚   â”‚   â”œâ”€â”€ emergency-alert.mp3
â”‚   â”‚   â”œâ”€â”€ check-in-reminder.mp3
â”‚   â”‚   â””â”€â”€ panic-button.mp3
â”‚   â””â”€â”€ ğŸ“ animations/                 # Lottie animations
â”œâ”€â”€ ğŸ“ src/                           # ğŸ§  Application source
â”‚   â”œâ”€â”€ ğŸ“ components/                 # Reusable UI components
â”‚   â”œâ”€â”€ ğŸ“ screens/                    # Screen components
â”‚   â”œâ”€â”€ ğŸ“ features/                   # Feature modules
â”‚   â”œâ”€â”€ ğŸ“ api/                        # Express.js API layer
â”‚   â”œâ”€â”€ ğŸ“ hooks/                      # Custom React hooks
â”‚   â”œâ”€â”€ ğŸ“ store/                      # Redux state management
â”‚   â”œâ”€â”€ ğŸ“ utils/                      # Utility functions
â”‚   â”œâ”€â”€ ğŸ“ types/                      # TypeScript definitions
â”‚   â”œâ”€â”€ ğŸ“ constants/                  # App constants
â”‚   â””â”€â”€ ğŸ“ styles/                     # Global styles
â”œâ”€â”€ ğŸ“„ app.json                       # Expo configuration
â”œâ”€â”€ ğŸ“„ eas.json                       # Build configuration
â”œâ”€â”€ ğŸ“„ package.json                   # Dependencies & scripts
â””â”€â”€ ğŸ“„ tsconfig.json                  # TypeScript config
```

```bash Express.js Backend Structure (shelther-backend/)
shelther-backend/
â”œâ”€â”€ ğŸ“ src/
â”‚   â”œâ”€â”€ ğŸ“ routes/                     # ğŸ›£ï¸ API endpoints
â”‚   â”‚   â”œâ”€â”€ auth.ts                    # Authentication routes
â”‚   â”‚   â”œâ”€â”€ emergency.ts               # Emergency alert routes
â”‚   â”‚   â”œâ”€â”€ location.ts                # Location tracking routes
â”‚   â”‚   â”œâ”€â”€ contacts.ts                # Emergency contacts routes
â”‚   â”‚   â””â”€â”€ health.ts                  # Health check routes
â”‚   â”œâ”€â”€ ğŸ“ services/                   # ğŸ”§ Business logic
â”‚   â”‚   â”œâ”€â”€ EmergencyService.ts        # Emergency alert processing
â”‚   â”‚   â”œâ”€â”€ LocationService.ts         # Location tracking service
â”‚   â”‚   â”œâ”€â”€ NotificationService.ts     # Multi-channel notifications
â”‚   â”‚   â”œâ”€â”€ AuthService.ts             # Authentication service
â”‚   â”‚   â””â”€â”€ CheckInService.ts          # Check-in monitoring
â”‚   â”œâ”€â”€ ğŸ“ middleware/                 # ğŸ›¡ï¸ Express middleware
â”‚   â”‚   â”œâ”€â”€ auth.ts                    # JWT authentication
â”‚   â”‚   â”œâ”€â”€ validation.ts              # Request validation
â”‚   â”‚   â”œâ”€â”€ rateLimiting.ts            # Rate limiting
â”‚   â”‚   â””â”€â”€ errorHandler.ts            # Error handling
â”‚   â”œâ”€â”€ ğŸ“ config/                     # âš™ï¸ Configuration
â”‚   â”‚   â”œâ”€â”€ database.ts                # PostgreSQL connection
â”‚   â”‚   â”œâ”€â”€ supabase.ts                # Supabase client
â”‚   â”‚   â””â”€â”€ railway.ts                 # Railway deployment
â”‚   â”œâ”€â”€ ğŸ“ jobs/                       # â° Background jobs
â”‚   â”‚   â”œâ”€â”€ CheckInMonitor.ts          # Check-in monitoring
â”‚   â”‚   â”œâ”€â”€ LocationCleanup.ts         # Data cleanup
â”‚   â”‚   â””â”€â”€ HealthCheck.ts             # System health
â”‚   â”œâ”€â”€ ğŸ“ utils/                      # ğŸ› ï¸ Utilities
â”‚   â”‚   â”œâ”€â”€ logger.ts                  # Structured logging
â”‚   â”‚   â”œâ”€â”€ errors.ts                  # Custom error classes
â”‚   â”‚   â””â”€â”€ validators.ts              # Data validation
â”‚   â””â”€â”€ ğŸ“ types/                      # ğŸ“ TypeScript types
â”œâ”€â”€ ğŸ“„ package.json                   # Backend dependencies
â”œâ”€â”€ ğŸ“„ tsconfig.json                  # TypeScript config
â”œâ”€â”€ ğŸ“„ railway.json                   # Railway deployment
â””â”€â”€ ğŸ“„ Dockerfile                     # Docker configuration
```
</CodeGroup>

### Database Structure

<Steps>
  <Step title="ğŸ—„ï¸ PostgreSQL Schema">
    Supabase provides the PostgreSQL database with spatial queries, real-time subscriptions, and RLS security
  </Step>
  <Step title="ğŸ“Š Migration System">
    Version-controlled database schema changes with rollback capability
  </Step>
  <Step title="ğŸ” Security Policies">
    Row Level Security policies protecting user data and emergency information
  </Step>
  <Step title="âš¡ Real-time Features">
    WebSocket-based real-time updates for location sharing and emergency alerts
  </Step>
</Steps>

## ğŸ—ï¸ Client Architecture Deep Dive

### Component Organization

<Note>
**Component Hierarchy:** Components organized by complexity and reusability - from basic UI elements to complex safety-specific components.
</Note>

```mermaid
graph TD
    A[ğŸ“± App.tsx] --> B[ğŸ§­ Navigation]
    A --> C[ğŸª Redux Store]
    A --> D[ğŸ¨ Theme Provider]
    
    B --> E[ğŸ“º Screens]
    B --> F[ğŸ“ Tab Navigation]
    B --> G[ğŸ”— Deep Linking]
    
    C --> H[ğŸš¨ Emergency State]
    C --> I[ğŸ‘¤ Auth State]
    C --> J[ğŸ“ Location State]
    
    E --> K[ğŸ  HomeScreen]
    E --> L[ğŸš¨ EmergencyScreen]
    E --> M[ğŸ‘¥ ContactsScreen]
    E --> N[âš™ï¸ SettingsScreen]
    
    K --> O[ğŸ§© Components]
    L --> O
    M --> O
    N --> O
    
    O --> P[ğŸ”˜ UI Components]
    O --> Q[ğŸš¨ Safety Components]
    O --> R[ğŸ“‹ Form Components]
    
    style A fill:#ff6b6b
    style H fill:#ff8a80
    style Q fill:#ffab91
```

<CardGroup cols={2}>
  <Card title="ğŸ”˜ UI Components" icon="palette">
    **Basic building blocks:** Button, Input, Card, Modal, Loading  
    **Reusable across features:** Consistent design system  
    **Accessibility first:** Screen reader support, high contrast
  </Card>
  <Card title="ğŸš¨ Safety Components" icon="shield-check">
    **Emergency-specific:** EmergencyButton, LocationSharing, CheckInReminder  
    **Critical isolation:** Separate testing and review processes  
    **Performance optimized:** Sub-100ms response times
  </Card>
</CardGroup>

<Accordion title="Component Directory Structure">
```bash
src/components/
â”œâ”€â”€ ğŸ“ ui/                             # ğŸ¨ Basic UI components
â”‚   â”œâ”€â”€ ğŸ“ Button/
â”‚   â”‚   â”œâ”€â”€ Button.tsx                 # Main component
â”‚   â”‚   â”œâ”€â”€ Button.test.tsx            # Unit tests
â”‚   â”‚   â”œâ”€â”€ Button.stories.tsx         # Storybook stories
â”‚   â”‚   â”œâ”€â”€ types.ts                   # TypeScript interfaces
â”‚   â”‚   â”œâ”€â”€ styles.ts                  # Component styles
â”‚   â”‚   â””â”€â”€ index.ts                   # Export file
â”‚   â”œâ”€â”€ ğŸ“ Input/
â”‚   â”œâ”€â”€ ğŸ“ Card/
â”‚   â”œâ”€â”€ ğŸ“ Modal/
â”‚   â””â”€â”€ ğŸ“ Loading/
â”œâ”€â”€ ğŸ“ safety/                         # ğŸš¨ Safety-critical components
â”‚   â”œâ”€â”€ ğŸ“ EmergencyButton/
â”‚   â”‚   â”œâ”€â”€ EmergencyButton.tsx        # Main emergency trigger
â”‚   â”‚   â”œâ”€â”€ EmergencyCountdown.tsx     # Countdown timer
â”‚   â”‚   â”œâ”€â”€ DuressMode.tsx             # Silent alert mode
â”‚   â”‚   â”œâ”€â”€ types.ts                   # Emergency types
â”‚   â”‚   â”œâ”€â”€ hooks.ts                   # Emergency hooks
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ ğŸ“ LocationSharing/
â”‚   â”œâ”€â”€ ğŸ“ CheckInReminder/
â”‚   â””â”€â”€ ğŸ“ SafetyStatus/
â”œâ”€â”€ ğŸ“ forms/                          # ğŸ“‹ Form components
â”‚   â”œâ”€â”€ ğŸ“ ContactForm/
â”‚   â”œâ”€â”€ ğŸ“ EmergencyContactForm/
â”‚   â””â”€â”€ ğŸ“ SettingsForm/
â””â”€â”€ ğŸ“ navigation/                     # ğŸ§­ Navigation components
    â”œâ”€â”€ ğŸ“ TabBar/
    â”œâ”€â”€ ğŸ“ HeaderActions/
    â””â”€â”€ ğŸ“ DrawerContent/
```

**Component Template:**
```typescript
// src/components/safety/EmergencyButton/EmergencyButton.tsx
import React, { useState, useCallback } from 'react';
import { Pressable, Text, View, Haptics } from 'react-native';
import { useEmergencyAlert } from '@/features/emergency';
import { useLocationTracking } from '@/features/location';
import { EmergencyCountdown } from './EmergencyCountdown';
import { styles } from './styles';
import type { EmergencyButtonProps } from './types';

export const EmergencyButton: React.FC<EmergencyButtonProps> = ({
  type = 'manual',
  countdown = 10,
  onTrigger,
  onCancel,
  disabled = false,
  style,
}) => {
  const [isPressed, setIsPressed] = useState(false);
  const [showCountdown, setShowCountdown] = useState(false);
  const { triggerEmergency, isTriggering } = useEmergencyAlert();
  const { getCurrentLocation } = useLocationTracking();

  const handlePress = useCallback(async () => {
    if (disabled || isTriggering) return;

    // Haptic feedback for emergency activation
    Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Heavy);
    
    setShowCountdown(true);
  }, [disabled, isTriggering]);

  const handleCountdownComplete = useCallback(async () => {
    try {
      const location = await getCurrentLocation();
      
      const alert = await triggerEmergency({
        type,
        location,
        timestamp: new Date().toISOString(),
      });

      onTrigger?.(alert);
      setShowCountdown(false);
    } catch (error) {
      console.error('Emergency trigger failed:', error);
      setShowCountdown(false);
    }
  }, [type, triggerEmergency, getCurrentLocation, onTrigger]);

  const handleCountdownCancel = useCallback(() => {
    setShowCountdown(false);
    onCancel?.();
  }, [onCancel]);

  if (showCountdown) {
    return (
      <EmergencyCountdown
        duration={countdown}
        onComplete={handleCountdownComplete}
        onCancel={handleCountdownCancel}
      />
    );
  }

  return (
    <Pressable
      style={[
        styles.emergencyButton,
        isPressed && styles.pressed,
        disabled && styles.disabled,
        style,
      ]}
      onPress={handlePress}
      onPressIn={() => setIsPressed(true)}
      onPressOut={() => setIsPressed(false)}
      disabled={disabled}
      testID="emergency-button"
      accessibilityRole="button"
      accessibilityLabel="Emergency Alert Button"
      accessibilityHint="Double tap to trigger emergency alert"
    >
      <View style={styles.buttonContent}>
        <Text style={styles.buttonText}>
          {isTriggering ? 'TRIGGERING...' : 'EMERGENCY'}
        </Text>
        <Text style={styles.subText}>Tap to Alert Contacts</Text>
      </View>
    </Pressable>
  );
};
```
</Accordion>

### Feature-Based Architecture

<Warning>
**Safety Feature Isolation:** Critical emergency features are completely isolated to prevent accidental modifications and ensure clear ownership boundaries.
</Warning>

```mermaid
graph LR
    A[ğŸš¨ Emergency Feature] --> B[Components]
    A --> C[API Integration]
    A --> D[State Management]
    A --> E[Background Tasks]
    
    B --> F[EmergencyButton]
    B --> G[EmergencyStatus]
    B --> H[ContactNotifications]
    
    C --> I[Express.js API]
    C --> J[Real-time Updates]
    
    D --> K[Redux Slice]
    D --> L[Emergency Selectors]
    
    E --> M[Location Tracking]
    E --> N[Push Notifications]
    
    style A fill:#ff5252
    style I fill:#7c4dff
    style K fill:#ff7043
```

<CodeGroup>
```bash Feature Module Structure
src/features/
â”œâ”€â”€ ğŸ“ emergency/                      # ğŸš¨ Emergency management
â”‚   â”œâ”€â”€ ğŸ“ components/                 # UI components
â”‚   â”‚   â”œâ”€â”€ EmergencyButton/
â”‚   â”‚   â”œâ”€â”€ EmergencyCountdown/
â”‚   â”‚   â”œâ”€â”€ EmergencyHistory/
â”‚   â”‚   â””â”€â”€ EmergencyStatus/
â”‚   â”œâ”€â”€ ğŸ“ api/                        # Express.js API integration
â”‚   â”‚   â”œâ”€â”€ emergencyAPI.ts            # API client methods
â”‚   â”‚   â”œâ”€â”€ types.ts                   # API request/response types
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ ğŸ“ hooks/                      # React hooks
â”‚   â”‚   â”œâ”€â”€ useEmergencyAlert.ts
â”‚   â”‚   â”œâ”€â”€ useEmergencyContacts.ts
â”‚   â”‚   â””â”€â”€ useEmergencyHistory.ts
â”‚   â”œâ”€â”€ ğŸ“ store/                      # Redux state
â”‚   â”‚   â”œâ”€â”€ emergencySlice.ts
â”‚   â”‚   â”œâ”€â”€ selectors.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ ğŸ“ utils/                      # Utilities
â”‚   â”‚   â”œâ”€â”€ emergencyValidation.ts
â”‚   â”‚   â””â”€â”€ emergencyFormatters.ts
â”‚   â””â”€â”€ index.ts                       # Public API
â”œâ”€â”€ ğŸ“ location/                       # ğŸ“ Location services
â”œâ”€â”€ ğŸ“ contacts/                       # ğŸ‘¥ Contact management
â”œâ”€â”€ ğŸ“ notifications/                  # ğŸ”” Notifications
â”œâ”€â”€ ğŸ“ checkins/                      # â° Check-in system
â”œâ”€â”€ ğŸ“ auth/                          # ğŸ” Authentication
â””â”€â”€ ğŸ“ settings/                      # âš™ï¸ User settings
```

```typescript API Integration Layer
// src/features/emergency/api/emergencyAPI.ts
import { apiClient } from '@/api/client';
import type { 
  EmergencyAlert, 
  CreateEmergencyRequest, 
  EmergencyContact 
} from './types';

class EmergencyAPI {
  private baseURL = '/api/emergency';

  async createEmergencyAlert(data: CreateEmergencyRequest): Promise<EmergencyAlert> {
    const response = await apiClient.post<EmergencyAlert>(
      `${this.baseURL}/trigger`,
      data
    );
    return response.data;
  }

  async cancelEmergencyAlert(alertId: string): Promise<void> {
    await apiClient.patch(`${this.baseURL}/${alertId}/cancel`);
  }

  async getEmergencyHistory(userId: string): Promise<EmergencyAlert[]> {
    const response = await apiClient.get<EmergencyAlert[]>(
      `${this.baseURL}/history/${userId}`
    );
    return response.data;
  }

  async getEmergencyContacts(userId: string): Promise<EmergencyContact[]> {
    const response = await apiClient.get<EmergencyContact[]>(
      `/api/contacts/${userId}/emergency`
    );
    return response.data;
  }

  async updateAlertStatus(
    alertId: string, 
    status: 'resolved' | 'false_alarm'
  ): Promise<EmergencyAlert> {
    const response = await apiClient.patch<EmergencyAlert>(
      `${this.baseURL}/${alertId}/status`,
      { status }
    );
    return response.data;
  }
}

export const emergencyAPI = new EmergencyAPI();

// src/features/emergency/hooks/useEmergencyAlert.ts
import { useCallback } from 'react';
import { useAppDispatch, useAppSelector } from '@/store';
import { emergencyAPI } from '../api';
import { emergencySlice } from '../store';
import type { CreateEmergencyRequest } from '../api/types';

export const useEmergencyAlert = () => {
  const dispatch = useAppDispatch();
  const { activeAlert, isLoading, error } = useAppSelector(
    state => state.emergency
  );

  const triggerEmergency = useCallback(async (
    request: CreateEmergencyRequest
  ) => {
    dispatch(emergencySlice.actions.setLoading(true));
    
    try {
      const alert = await emergencyAPI.createEmergencyAlert(request);
      dispatch(emergencySlice.actions.setActiveAlert(alert));
      return alert;
    } catch (error) {
      dispatch(emergencySlice.actions.setError(error.message));
      throw error;
    } finally {
      dispatch(emergencySlice.actions.setLoading(false));
    }
  }, [dispatch]);

  const cancelEmergency = useCallback(async (alertId: string) => {
    await emergencyAPI.cancelEmergencyAlert(alertId);
    dispatch(emergencySlice.actions.clearActiveAlert());
  }, [dispatch]);

  return {
    activeAlert,
    isLoading,
    error,
    triggerEmergency,
    cancelEmergency,
  };
};
```
</CodeGroup>

## ğŸ”— API Integration Architecture

### Express.js Backend Communication

<Note>
**Centralized Backend:** All business logic, authentication, and external service integrations happen in the Express.js backend, not directly in the mobile client.
</Note>

```mermaid
sequenceDiagram
    participant C as ğŸ“± React Native
    participant E as ğŸŒ Express.js
    participant D as ğŸ—„ï¸ Supabase DB
    participant S as ğŸ“¨ External Services
    
    C->>E: POST /api/emergency/trigger
    E->>E: Validate JWT Token
    E->>E: Process Emergency Logic
    E->>D: Store Emergency Alert
    E->>S: Send SMS/Email Notifications
    E->>D: Update Contact Notifications
    E->>C: Return Emergency Alert
    
    Note over C,S: All business logic in Express.js
```

<CardGroup cols={2}>
  <Card title="ğŸ¯ Client Responsibilities" icon="mobile">
    **UI/UX:** User interface and interactions  
    **State Management:** Local app state with Redux  
    **Background Tasks:** Location tracking, push notifications  
    **Offline Support:** Cache critical data locally
  </Card>
  <Card title="âš™ï¸ Backend Responsibilities" icon="server">
    **Business Logic:** Emergency processing, validation  
    **Authentication:** JWT tokens, session management  
    **External Services:** SMS, email, third-party APIs  
    **Database Operations:** All CRUD operations
  </Card>
</CardGroup>

<CodeGroup>
```typescript API Client Configuration
// src/api/client.ts
import axios, { AxiosInstance, AxiosRequestConfig } from 'axios';
import { tokenManager } from '@/features/auth';
import { config } from '@/constants';

class APIClient {
  private client: AxiosInstance;
  
  constructor() {
    this.client = axios.create({
      baseURL: config.api.baseURL, // Railway Express.js backend
      timeout: config.api.timeout,
      headers: {
        'Content-Type': 'application/json',
        'X-Client-Version': config.app.version,
      },
    });

    this.setupInterceptors();
  }

  private setupInterceptors() {
    // Request interceptor - add JWT token
    this.client.interceptors.request.use(
      async (config) => {
        const token = await tokenManager.getAccessToken();
        if (token) {
          config.headers.Authorization = `Bearer ${token}`;
        }
        return config;
      },
      (error) => Promise.reject(error)
    );

    // Response interceptor - handle auth errors
    this.client.interceptors.response.use(
      (response) => response,
      async (error) => {
        if (error.response?.status === 401) {
          // Token expired, try to refresh
          const refreshed = await tokenManager.refreshToken();
          if (refreshed) {
            // Retry original request
            return this.client.request(error.config);
          } else {
            // Redirect to login
            await tokenManager.clearTokens();
            // Handle logout logic
          }
        }
        return Promise.reject(error);
      }
    );
  }

  async get<T>(url: string, config?: AxiosRequestConfig): Promise<T> {
    const response = await this.client.get(url, config);
    return response.data;
  }

  async post<T>(url: string, data?: any, config?: AxiosRequestConfig): Promise<T> {
    const response = await this.client.post(url, data, config);
    return response.data;
  }

  async patch<T>(url: string, data?: any, config?: AxiosRequestConfig): Promise<T> {
    const response = await this.client.patch(url, data, config);
    return response.data;
  }

  async delete<T>(url: string, config?: AxiosRequestConfig): Promise<T> {
    const response = await this.client.delete(url, config);
    return response.data;
  }
}

export const apiClient = new APIClient();
```

```typescript Real-time Integration
// src/features/emergency/api/realtime.ts
import { createClient } from '@supabase/supabase-js';
import { config } from '@/constants';
import type { EmergencyAlert } from './types';

class EmergencyRealtimeService {
  private supabase;
  private subscription: any;

  constructor() {
    this.supabase = createClient(
      config.supabase.url,
      config.supabase.anonKey
    );
  }

  subscribeToEmergencyUpdates(
    userId: string,
    onUpdate: (alert: EmergencyAlert) => void
  ) {
    this.subscription = this.supabase
      .channel('emergency-updates')
      .on(
        'postgres_changes',
        {
          event: '*',
          schema: 'public',
          table: 'emergency_alerts',
          filter: `user_id=eq.${userId}`,
        },
        (payload) => {
          if (payload.eventType === 'INSERT' || payload.eventType === 'UPDATE') {
            onUpdate(payload.new as EmergencyAlert);
          }
        }
      )
      .subscribe();

    return () => {
      this.subscription?.unsubscribe();
    };
  }

  subscribeToLocationSharing(
    contactIds: string[],
    onLocationUpdate: (location: any) => void
  ) {
    const channels = contactIds.map(contactId => 
      this.supabase
        .channel(`location-${contactId}`)
        .on(
          'postgres_changes',
          {
            event: 'INSERT',
            schema: 'public',
            table: 'location_updates',
            filter: `user_id=eq.${contactId}`,
          },
          (payload) => {
            onLocationUpdate(payload.new);
          }
        )
        .subscribe()
    );

    return () => {
      channels.forEach(channel => channel.unsubscribe());
    };
  }
}

export const emergencyRealtimeService = new EmergencyRealtimeService();
```
</CodeGroup>

## ğŸ“Š State Management Architecture

### Redux Toolkit + React Query

<Steps>
  <Step title="ğŸª Redux for App State">
    Global application state like authentication, user preferences, and current emergency status
  </Step>
  <Step title="ğŸ”„ React Query for Server State">
    Server data caching, background updates, and optimistic updates for API operations
  </Step>
  <Step title="ğŸ“± Local State for UI">
    Component-level state for forms, modals, and temporary UI interactions
  </Step>
  <Step title="ğŸ’¾ Offline State">
    Critical data cached locally for offline emergency functionality
  </Step>
</Steps>

```mermaid
graph TB
    A[ğŸ“± React Native App] --> B[ğŸª Redux Store]
    A --> C[ğŸ”„ React Query]
    A --> D[ğŸ“± Local State]
    
    B --> E[ğŸ” Auth Slice]
    B --> F[ğŸš¨ Emergency Slice]
    B --> G[âš™ï¸ Settings Slice]
    B --> H[ğŸ“ Location Slice]
    
    C --> I[ğŸ‘¥ Contacts Queries]
    C --> J[ğŸ“Š Emergency History]
    C --> K[ğŸ—„ï¸ User Profile]
    
    D --> L[ğŸ“‹ Form State]
    D --> M[ğŸ¨ UI State]
    D --> N[ğŸ”” Modal State]
    
    style B fill:#4fc3f7
    style C fill:#81c784
    style F fill:#ff8a65
```

<CardGroup cols={3}>
  <Card title="ğŸª Redux Store" icon="database">
    **Global App State:** Authentication, emergency status, user settings  
    **Persistent:** Survives app restarts with redux-persist  
    **Predictable:** Time-travel debugging with Redux DevTools
  </Card>
  <Card title="ğŸ”„ React Query" icon="refresh-cw">
    **Server State:** API data caching and synchronization  
    **Background Updates:** Automatic data refresh and invalidation  
    **Optimistic Updates:** Instant UI feedback with rollback capability
  </Card>
  <Card title="ğŸ’¾ Offline Support" icon="wifi-off">
    **Critical Data Cached:** Emergency contacts, user profile, last known location  
    **Queue System:** Offline actions queued and synced when online  
    **Graceful Degradation:** Core safety features work without internet
  </Card>
</CardGroup>

## ğŸ§ª Testing Architecture

### Comprehensive Testing Strategy

<Warning>
**Safety-Critical Testing:** Emergency and safety features require 100% test coverage with specialized testing scenarios including offline conditions, network failures, and edge cases.
</Warning>

```mermaid
graph TD
    A[ğŸ§ª Testing Strategy] --> B[ğŸ”¬ Unit Tests]
    A --> C[ğŸ”— Integration Tests]
    A --> D[ğŸ­ E2E Tests]
    A --> E[ğŸ›¡ï¸ Safety Tests]
    
    B --> F[Components]
    B --> G[Hooks]
    B --> H[Utils]
    B --> I[Services]
    
    C --> J[Feature Flows]
    C --> K[API Integration]
    C --> L[State Management]
    
    D --> M[User Journeys]
    D --> N[Emergency Scenarios]
    D --> O[Cross-Platform]
    
    E --> P[Offline Emergency]
    E --> Q[Network Failures]
    E --> R[Battery Critical]
    E --> S[Location Accuracy]
    
    style A fill:#f06292
    style E fill:#ff7043
    style N fill:#ef5350
```

<Accordion title="Testing Directory Structure">
```bash
__tests__/
â”œâ”€â”€ ğŸ“ unit/                          # ğŸ”¬ Unit tests (95% coverage)
â”‚   â”œâ”€â”€ ğŸ“ components/
â”‚   â”‚   â”œâ”€â”€ EmergencyButton.test.tsx   # Critical component testing
â”‚   â”‚   â”œâ”€â”€ LocationSharing.test.tsx
â”‚   â”‚   â””â”€â”€ ContactForm.test.tsx
â”‚   â”œâ”€â”€ ğŸ“ hooks/
â”‚   â”‚   â”œâ”€â”€ useEmergencyAlert.test.ts  # Hook behavior testing
â”‚   â”‚   â”œâ”€â”€ useLocation.test.ts
â”‚   â”‚   â””â”€â”€ useAuth.test.ts
â”‚   â”œâ”€â”€ ğŸ“ api/
â”‚   â”‚   â”œâ”€â”€ emergencyAPI.test.ts       # API client testing
â”‚   â”‚   â”œâ”€â”€ locationAPI.test.ts
â”‚   â”‚   â””â”€â”€ authAPI.test.ts
â”‚   â””â”€â”€ ğŸ“ utils/
â”‚       â”œâ”€â”€ validators.test.ts
â”‚       â””â”€â”€ formatters.test.ts
â”œâ”€â”€ ğŸ“ integration/                   # ğŸ”— Integration tests
â”‚   â”œâ”€â”€ ğŸ“ features/
â”‚   â”‚   â”œâ”€â”€ emergency-flow.test.tsx    # Complete feature testing
â”‚   â”‚   â”œâ”€â”€ location-sharing.test.tsx
â”‚   â”‚   â””â”€â”€ contact-management.test.tsx
â”‚   â”œâ”€â”€ ğŸ“ store/
â”‚   â”‚   â”œâ”€â”€ emergency-store.test.ts    # Redux integration
â”‚   â”‚   â””â”€â”€ auth-store.test.ts
â”‚   â””â”€â”€ ğŸ“ api/
â”‚       â””â”€â”€ backend-integration.test.ts
â”œâ”€â”€ ğŸ“ e2e/                          # ğŸ­ End-to-end tests
â”‚   â”œâ”€â”€ ğŸ“ emergency/
â”‚   â”‚   â”œâ”€â”€ trigger-emergency.e2e.ts   # Critical user journeys
â”‚   â”‚   â”œâ”€â”€ cancel-emergency.e2e.ts
â”‚   â”‚   â””â”€â”€ emergency-contacts.e2e.ts
â”‚   â”œâ”€â”€ ğŸ“ onboarding/
â”‚   â”‚   â””â”€â”€ complete-setup.e2e.ts
â”‚   â””â”€â”€ ğŸ“ settings/
â”‚       â””â”€â”€ safety-preferences.e2e.ts
â”œâ”€â”€ ğŸ“ safety/                       # ğŸ›¡ï¸ Safety-specific tests
â”‚   â”œâ”€â”€ offline-emergency.test.ts     # Offline functionality
â”‚   â”œâ”€â”€ network-failures.test.ts     # Network resilience
â”‚   â”œâ”€â”€ battery-critical.test.ts     # Low battery scenarios
â”‚   â”œâ”€â”€ location-accuracy.test.ts    # GPS accuracy testing
â”‚   â””â”€â”€ notification-delivery.test.ts # Alert delivery testing
â”œâ”€â”€ ğŸ“ __mocks__/                    # ğŸ­ Global mocks
â”‚   â”œâ”€â”€ @react-native-async-storage/
â”‚   â”œâ”€â”€ expo-location/
â”‚   â”œâ”€â”€ expo-notifications/
â”‚   â””â”€â”€ axios/
â”œâ”€â”€ ğŸ“ fixtures/                     # ğŸ“Š Test data
â”‚   â”œâ”€â”€ users.ts
â”‚   â”œâ”€â”€ emergencyAlerts.ts
â”‚   â”œâ”€â”€ locations.ts
â”‚   â””â”€â”€ contacts.ts
â”œâ”€â”€ ğŸ“ helpers/                      # ğŸ› ï¸ Test utilities
â”‚   â”œâ”€â”€ renderWithProviders.tsx      # React Testing Library wrapper
â”‚   â”œâ”€â”€ mockAPI.ts                   # API mocking utilities
â”‚   â”œâ”€â”€ testStore.ts                 # Redux store for testing
â”‚   â””â”€â”€ emergencyHelpers.ts          # Emergency testing utilities
â””â”€â”€ setup.ts                        # Test environment setup
```

**Safety Testing Example:**
```typescript
// __tests__/safety/offline-emergency.test.ts
import { renderHook, act } from '@testing-library/react-hooks';
import { useEmergencyAlert } from '@/features/emergency';
import { apiClient } from '@/api/client';
import { mockLocation, mockEmergencyContacts } from '../fixtures';

// Mock network conditions
jest.mock('@react-native-community/netinfo', () => ({
  useNetInfo: () => ({ isConnected: false }),
}));

describe('Offline Emergency Functionality', () => {
  beforeEach(() => {
    // Clear all mocks
    jest.clearAllMocks();
    
    // Mock AsyncStorage for offline data
    jest.spyOn(require('@react-native-async-storage/async-storage'), 'setItem')
      .mockResolvedValue(undefined);
  });

  test('should trigger emergency alert while offline', async () => {
    const { result } = renderHook(() => useEmergencyAlert());

    await act(async () => {
      const alert = await result.current.triggerEmergency({
        type: 'manual',
        message: 'Test offline emergency',
      });

      expect(alert).toBeDefined();
      expect(alert.status).toBe('active');
    });

    // Verify offline storage
    expect(require('@react-native-async-storage/async-storage').setItem)
      .toHaveBeenCalledWith(
        expect.stringMatching(/emergency_alert_/),
        expect.any(String)
      );
  });

  test('should queue notifications for when online', async () => {
    const mockSMSQueue = jest.spyOn(require('@/services/notifications'), 'queueSMS');
    
    const { result } = renderHook(() => useEmergencyAlert());

    await act(async () => {
      await result.current.triggerEmergency({
        type: 'panic',
        location: mockLocation,
      });
    });

    expect(mockSMSQueue).toHaveBeenCalledWith(
      expect.objectContaining({
        type: 'emergency_alert',
        contacts: expect.any(Array),
        location: mockLocation,
      })
    );
  });

  test('should maintain location tracking during offline emergency', async () => {
    const mockLocationService = jest.spyOn(
      require('@/services/location'), 
      'startContinuousTracking'
    );

    const { result } = renderHook(() => useEmergencyAlert());

    await act(async () => {
      await result.current.triggerEmergency({ type: 'manual' });
    });

    expect(mockLocationService).toHaveBeenCalledWith({
      highAccuracy: true,
      interval: 30000, // 30 seconds
      storeLocally: true, // Store offline
    });
  });
});
```
</Accordion>

## âš™ï¸ Configuration Management

### Environment-Specific Settings

<Note>
**Security First:** All sensitive configuration stored in environment variables with different settings for development, staging, and production environments.
</Note>

<CardGroup cols={3}>
  <Card title="ğŸ”§ Development" icon="code">
    **Debug Mode:** Enabled with verbose logging  
    **Mock Services:** Optional API mocking  
    **Hot Reload:** Fast development iteration
  </Card>
  <Card title="ğŸ§ª Staging" icon="test-tube">
    **Production-like:** Same architecture as production  
    **Test Data:** Safe test environment  
    **Performance Testing:** Load testing environment
  </Card>
  <Card title="ğŸš€ Production" icon="rocket">
    **Optimized:** Minified bundles, tree-shaking  
    **Monitoring:** Full analytics and error tracking  
    **Security:** All security features enabled
  </Card>
</CardGroup>

<CodeGroup>
```typescript Configuration Management
// src/constants/config.ts
interface AppConfig {
  app: {
    name: string;
    version: string;
    environment: 'development' | 'staging' | 'production';
  };
  api: {
    baseURL: string;        // Railway Express.js backend
    timeout: number;
    retryAttempts: number;
  };
  supabase: {
    url: string;           // Direct Supabase for real-time
    anonKey: string;
  };
  features: {
    crashReporting: boolean;
    analytics: boolean;
    debugMode: boolean;
    offlineMode: boolean;
  };
  safety: {
    emergencyTimeoutSeconds: number;
    locationAccuracyMeters: number;
    maxEmergencyContacts: number;
    autoEscalationMinutes: number;
  };
}

const createConfig = (): AppConfig => {
  const environment = process.env.EXPO_PUBLIC_APP_ENV as AppConfig['app']['environment'] || 'development';
  const isDevelopment = environment === 'development';
  
  return {
    app: {
      name: 'Shelther',
      version: process.env.EXPO_PUBLIC_APP_VERSION || '1.0.0',
      environment,
    },
    api: {
      baseURL: process.env.EXPO_PUBLIC_API_BASE_URL || 'http://localhost:3000',
      timeout: isDevelopment ? 15000 : 8000,
      retryAttempts: isDevelopment ? 1 : 3,
    },
    supabase: {
      url: process.env.EXPO_PUBLIC_SUPABASE_URL!,
      anonKey: process.env.EXPO_PUBLIC_SUPABASE_ANON_KEY!,
    },
    features: {
      crashReporting: !isDevelopment,
      analytics: !isDevelopment,
      debugMode: isDevelopment,
      offlineMode: true,
    },
    safety: {
      emergencyTimeoutSeconds: 10,
      locationAccuracyMeters: 10,
      maxEmergencyContacts: 5,
      autoEscalationMinutes: 30,
    },
  };
};

export const config = createConfig();

// Validate required environment variables
const requiredEnvVars = [
  'EXPO_PUBLIC_API_BASE_URL',
  'EXPO_PUBLIC_SUPABASE_URL',
  'EXPO_PUBLIC_SUPABASE_ANON_KEY',
];

for (const envVar of requiredEnvVars) {
  if (!process.env[envVar]) {
    throw new Error(`âŒ Missing required environment variable: ${envVar}`);
  }
}
```

```json Environment Files
// .env.development
EXPO_PUBLIC_APP_ENV=development
EXPO_PUBLIC_API_BASE_URL=http://localhost:3000
EXPO_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
EXPO_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
EXPO_PUBLIC_APP_VERSION=1.0.0-dev

// .env.staging  
EXPO_PUBLIC_APP_ENV=staging
EXPO_PUBLIC_API_BASE_URL=https://shelther-staging.railway.app
EXPO_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
EXPO_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
EXPO_PUBLIC_APP_VERSION=1.0.0-staging

// .env.production
EXPO_PUBLIC_APP_ENV=production
EXPO_PUBLIC_API_BASE_URL=https://shelther-api.railway.app
EXPO_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
EXPO_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
EXPO_PUBLIC_APP_VERSION=1.0.0
```
</CodeGroup>

## ğŸš€ Best Practices Summary

### Safety-Critical Development Guidelines

<Steps>
  <Step title="ğŸ”’ Security First">
    Never store sensitive data in client code, use environment variables, implement proper authentication flows
  </Step>
  <Step title="ğŸ§ª Test Everything">
    100% coverage for safety features, offline testing, network failure scenarios, edge case validation
  </Step>
  <Step title="ğŸ“Š Monitor Performance">
    Track emergency response times, location accuracy, notification delivery rates, battery usage
  </Step>
  <Step title="ğŸ›¡ï¸ Graceful Degradation">
    Core safety features work offline, fallback mechanisms for service failures, clear user feedback
  </Step>
</Steps>

<CardGroup cols={2}>
  <Card title="âœ… Do This" icon="check-circle">
    **Isolate safety features** in dedicated modules  
    **Use TypeScript strictly** with no `any` types  
    **Test offline scenarios** for all critical features  
    **Document complex logic** especially emergency flows  
    **Monitor performance** of safety-critical operations
  </Card>
  <Card title="âŒ Avoid This" icon="x-circle">
    **Direct database access** from client code  
    **Storing secrets** in client-side code  
    **Skipping tests** for emergency functionality  
    **Complex state mutations** without proper validation  
    **Ignoring offline scenarios** in safety features
  </Card>
</CardGroup>

---

## ğŸ¯ Next Steps

<CardGroup cols={3}>
  <Card title="ğŸ—ï¸ Backend Setup" icon="server" href="/development/express-setup">
    Set up your Express.js backend with Railway deployment and Supabase integration
  </Card>
  <Card title="ğŸ“± Component Development" icon="components" href="/development/component-development">
    Build React Native components with proper testing and accessibility support
  </Card>
  <Card title="ğŸ§ª Testing Strategy" icon="test-tube" href="/development/testing-strategy">
    Implement comprehensive testing for safety-critical mobile applications
  </Card>
</CardGroup>

<Info>
**Architecture Foundation:** This structure provides a scalable, maintainable foundation for building safety-critical applications with clear separation of concerns and comprehensive testing coverage.
</Info>